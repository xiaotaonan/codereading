# 导语

如今，我们能从阅读中得到什么，能与头十四年的兴奋和启示相媲美呢？
-Graham Greene

阅读代码可能是计算专业人员最常见的活动之一，但很少将其作为一门学科进行教授或正式用作学习如何设计和编程的方法。

造成这种悲惨情况的原因之一可能是缺乏现实世界或高质量的代码可供阅读。 公司通常将源代码作为商业秘密进行保护，很少允许其他人阅读、评论、试验并从中学习。 在少数情况下，重要的专有代码被允许从公司的秘密中泄露出来，这激发了巨大的兴趣和创造性的进步。 例如，一代程序员受益于 John Lions 的《Unix 操作系统评论》，其中列出并注释了第六版 Unix 内核的完整源代码。 尽管 Lions 的书最初是在 AT&T 的资助下编写的，用于操作系统课程，并且不向公众开放，但该书的副本作为盗版第 n 代复印件流传了多年。

然而，在过去几年中，开源软件的流行为我们提供了大量可以免费阅读的代码。 当今使用的一些最流行的软件系统，例如 Apache Web 服务器、Perl 语言、GNU/Linux 操作系统、BIND 域名服务器和 sendmail 邮件传输代理实际上都是以开源形式提供的。 因此，我很幸运能够使用上述开源软件来编写本书，作为软件代码的入门书和阅读器。 我的目标是提供阅读其他人编写的代码的背景知识和技术。 通过使用从工作中的开源项目中获取的现实示例，我试图涵盖与软件开发人员眼前可能出现的代码相关的大多数概念，包括编程结构、数据类型、数据结构、控制流、项目 组织、编码标准、文档和架构。 本书的配套标题将涵盖接口和面向应用程序的代码，包括国际化和可移植性问题、常用库和操作系统的元素、低级代码、特定领域和声明性语言、脚本语言以及混合语言。 语言系统。

据我所知，这本书是第一本专门将代码阅读作为一项独特的活动来处理的书，它本身就有价值。 因此，我确信不可避免地会有缺陷，其中一些内容可以得到更好的处理方式，并且我错过了重要的材料。 我坚信，阅读代码应该得到正确的教授，并作为提高编程能力的一种方法。 因此，我希望这本书能够激发人们的兴趣，将代码阅读课程、活动和练习纳入计算教育课程，以便几年后我们的学生能够从现有的开源系统中学习，就像他们学习语言的同龄人一样 伟大的文学。

# 补充材料

提供的许多源代码示例都来自 NetBSD 的源代码发行版。 NetBSD 是一个免费、高度可移植的类 Unix 操作系统，适用于从 64 位 AlphaServer 到手持设备的许多平台。 其简洁的设计和先进的功能使其成为生产和研究环境的绝佳选择。 我选择 NetBSD 而不是其他同样令人钦佩且非常流行的免费类 Unix 系统（例如 GNU/Linux、FreeBSD 和 OpenBSD），因为 NetBSD 项目的主要目标是强调正确的设计和编写良好的代码，从而使其成为 提供示例源代码的绝佳选择。 根据其开发人员的说法，某些系统似乎有这样的理念：“如果它有效，那就是正确的”，而 NetBSD 可以被描述为“除非它正确，否则它不会工作”。 此外，其他一些 NetBSD 目标也与本书的目标特别契合。 具体来说，NeBtSD 项目避免了许可证的阻碍，提供了在许多硬件平台上运行的便携式系统，与其他系统具有良好的互操作性，并尽可能符合开放系统标准。 本书中使用的代码是（现在具有历史意义的）export-19980407 快照。 一些例子涉及我在代码中发现的错误； 随着 NetBSD 代码的不断发展，提供最新版本的示例将意味着冒着那些现实的宝石被纠正的风险。

我出于类似的原因选择了本书示例中使用的其余系统：代码质量、结构、设计、实用性、流行度以及不会让我的出版商紧张的许可证。 我努力平衡语言的选择，积极寻找合适的 Java 和 C++ 代码。 然而，如果可以使用不同的语言演示类似的概念，我选择使用 C 作为最小公分母。

我有时使用真实的代码示例来说明不安全、不可移植、不可读或其他应受谴责的编码实践。 我很理解，我可能会被指责贬低作者出于善意贡献的代码，这些代码是为了推动开源运动并得到改进而不是仅仅受到批评。 如果我的评论对源代码作者造成任何冒犯，我真诚地道歉。 在辩护中，我认为在大多数情况下，注释并不针对特定的代码摘录，而是用它来说明应该避免的做法。 通常，我用作反例的代码是跛脚鸭，因为它是在技术和其他限制证明特定编码实践合理的时候编写的，或者特定实践受到断章取义的批评。 无论如何，我希望大家能以幽默的态度接受这些评论，并且我公开承认我自己的代码包含类似的，甚至可能更糟糕的不当行为。

# 致谢

许多人慷慨地提供了建议、评论和他们的时间，帮助本书成为现实。 Addison-Wesley 组建了我认为是理想的审稿人团队：Paul C. Clements、Robert L. Glass、Scott D. Meyers、Guy Steele、Dave Thomas 和 John Vlissides 慷慨地以比您阅读的形式更为粗糙的形式阅读了手稿。 掌握在您手中，并通过深思熟虑、富有洞察力且常常令人大开眼界的评论分享他们的经验和智慧。 此外，Eliza Fragaki、Georgios Chrisoloras、Kleanthis Georgaris、Isidor Kouvelas 和 Lorenzo Vicisano 以非正式身份阅读了部分手稿，并提出了许多有用的评论和建议。 我还很幸运地从 Bill Cheswick、Christine Hogan、Tom Limoncelli 和 Antonis Tsolomitis 那里获得了有关制作过程机制的建议。 此外，George Gousios建议使用Tom-cat作为Java开源软件材料，并向我解释了它的操作细节，向我介绍了ant构建工具，并澄清了有关DocBook文档格式使用的问题。 Stephen Ma 解决了 vnode 指针如何在操作系统设备驱动程序级别结束的谜团（参见第 9.1.4 节）。 Spyros Oikonomopoulos 向我提供了基于 UML 的建模工具的逆向工程功能的概述。 Panagiotis Petropoulos 更新了书籍参考文献。 Konstantina Vassilopoulou 在带注释的代码列表的可读性方面向我提供了建议。 Ioanna Grinia、Vasilis Karakoidas、Nikos Korfiatis、Vasiliki Tangalaki 和 George M. Zouganelis 对本书的布局发表了自己的看法。 阿森·托利斯在伦敦科学博物馆图书馆找到了第五章的警句。

Elizabeth Ryan 和 ITC 的工作人员耐心地设计并重新设计了这本书，直到我们都同意它具有正确的外观。

我的编辑，Addison-Wesley 的 Ross Venables 和 Mike Hendrickson，以卓越的效率处理了这本书的制作。 2001 年夏天，在我们第一次建立联系一周后，罗斯就已经将稿件提案送去审核； 由于存在七小时的时差，我通常会发现在工作日结束时提出的任何问题在早上打开电子邮件时都会得到解决。 他们在确保审稿人、回答我经常提出的幼稚问题、处理本书的合同方面以及协调复杂的制作过程方面的效率令人难以置信，这对于使这个项目取得成果至关重要。 后来，Elizabeth Ryan 熟练地同步了 Addision-Wesley 的制作团队； Chrysta Meadowbrooke 勤奋地对我的（通常是粗糙的）手稿进行了校对，表现出对其技术内容的令人钦佩的理解； ITC 处理了艰巨的合成任务； 詹妮弗·伦德伯格耐心地向我介绍了图书营销的奥秘。

本书中使用的绝大多数示例都是现有开源项目的一部分。 使用现实生活中的代码使我能够呈现人们可能遇到的代码类型，而不是简化的玩具程序。 因此，我要感谢我使用的开源材料的所有贡献者与编程社区分享他们的工作。 书中出现的代码的贡献者姓名在相应的源代码文件中列出时出现在附录 B 中。